<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ja" lang="ja">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>saz.js saz.scene</title>
<meta name="language" content="ja" />

<style type="text/css">
.page{
	position: absolute;
	width: 640px;
	height: 480px;
	color: #ccc;
	background: #666;
	border: 1px dotted #999;
	
	text-align: center;
	font-family: 'Verdana', sans-serif;
	font-size: 100px;
	line-height: 480px;
}
.navi li{
	float: left;
	list-style: none;
	margin-right: 1px;
	padding: 0 10px;
	background: #ccc;
}
.page{
	clear: both;
	margin-top: 30px;
}
</style>
</head>
<body>
<h1>saz.js saz.scene</h1>
<div id="container">
<p>クリック↓</p>
<ul class="navi">
	<li id="intro">intro</li>
	<li id="top">top</li>
</ul>
<div class="page" id="introPage">Intro</div>
<div class="page" id="topPage">Top</div>
</div>

<script type="text/javascript" src="../libs/dojo/dojo.js"></script>
<script type="text/javascript" src="../libs/easel.js"></script>
<script type="text/javascript" src="../libs/tween.js"></script>

<script type="text/javascript" src="js/saz.js"></script>
<script type="text/javascript" src="js/saz.deferred.js"></script>
<script type="text/javascript" src="js/saz.scene.js"></script>

<script type="text/javascript">

// init DOM
var introPage = dojo.byId('introPage');
var topPage = dojo.byId('topPage');
dojo.style(introPage, 'opacity', 0);
dojo.style(topPage, 'opacity', 0);


// Scene
var intro = new SAZ.scene.Scene('intro');
intro.from = function(scene) {
	console.log('intro.from');
	return SAZ.deferred.tween(Tween.get(introPage.style, {css:true}).to({opacity:1},1000));
};
intro.to = function(scene) {
	console.log('intro.to');
	return SAZ.deferred.tween(Tween.get(introPage.style, {css:true}).to({opacity:0},1000));
};

var top = new SAZ.scene.Scene('top');
top.from = function(scene) {
	console.log('top.from');
	// 1秒待つ
	var d = SAZ.deferred.wait(1000);
	d.then(SAZ.deferred.thenTween(Tween.get(topPage.style, {css:true}).to({opacity:1},1000)));
	return d;
};
top.to = function(scene) {
	console.log('top.to');
	// 1秒待つ
	var d = new dojo.Deferred();
	setTimeout(function(){
		d.resolve();
	},1000);
	d.then(SAZ.deferred.thenTween(Tween.get(topPage.style, {css:true}).to({opacity:0},1000)));
	return d;
};

// SceneContainer
var sman = new SAZ.scene.SceneContainer('main');
sman.add(intro);
sman.add(top);
console.log('sman.currentId='+sman.currentId);
console.dir(sman.current);


// ボタン設定
dojo.connect(dojo.byId('intro'), 'onclick', function() {
	sman.change('intro').then(function() {
		console.log('COMP!')
	});
});
dojo.connect(dojo.byId('top'), 'onclick', function() {
	sman.change('top').then(function() {
		console.log('COMP!')
	});
});

//console.log('sman.currentId='+sman.currentId);
//console.dir(sman.current);

</script>

</body>
</html>
